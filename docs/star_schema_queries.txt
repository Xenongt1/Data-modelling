QUESTION 1: Monthly Encounters by Specialty
SQL Query:
SELECT 
    d.month_name,
    s.specialty_name,
    t.encounter_type_name,
    COUNT(f.encounter_key) as total_encounters,
    COUNT(DISTINCT f.patient_key) as unique_patients
FROM fact_encounters f
JOIN dim_date d ON f.date_key = d.date_key
JOIN dim_specialty s ON f.specialty_key = s.specialty_key
JOIN dim_encounter_type t ON f.encounter_type_key = t.encounter_type_key
GROUP BY d.year, d.month, d.month_name, s.specialty_name, t.encounter_type_name;

Execution time estimate: ~223ms (vs 146ms OLTP)

Improvement factor: 0.65x (Slight Regression)

Performance Analysis:
- **OLTP**: **146ms**.
    - **Why**: Very efficient coverage. Only joined 2 tables (`providers`, `specialties`). The bottleneck was sorting (133ms).
- **Star Schema**: **223ms**.
    - **Strategy**: Star Join Optimization. Joined 3 Dimension tables (`date`, `specialty`, `encounter_type`).
    - **Why Slower?**: The Overhead of joining one extra table (`dim_date`) plus the generic nature of the Star Schema adds slight latency for simple queries.
- **Verdict**: **0.65x (Slight Regression)**.
    - **Insight**: Star Schemas are not magic bullets for *simple* queries. If an OLTP query is already blazing fast (146ms) with covering indexes, a Star Schema won't beat it. The Star Schema's value is **Consistency** and **Scalability**.

---------------------------------------------------

QUESTION 2: Top Diagnosis-Procedure Pairs
SQL Query:
SELECT 
    dd.icd10_code,
    dp.cpt_code,
    COUNT(bd.encounter_key) as overlap_count
FROM bridge_encounter_diagnoses bd
JOIN bridge_encounter_procedures bp ON bd.encounter_key = bp.encounter_key
JOIN dim_diagnosis dd ON bd.diagnosis_key = dd.diagnosis_key
JOIN dim_procedure dp ON bp.procedure_key = dp.procedure_key
GROUP BY 1, 2
ORDER BY 3 DESC
LIMIT 10;

Execution time estimate: ~425ms (vs 1.2s OLTP)

Improvement factor: ~2.8x FASTER

Performance Analysis:
- **OLTP**: **1.21s**.
    - **Bottleneck**: Row Explosion. Joining 5 tables (`encounters`, `diagnoses`, `procedures`, etc.) caused a Cartesian product for each encounter.
- **Star Schema**: **425ms**.
    - **Strategy**: Direct Bridge Join.
    - **Plan**: Joined `bridge_encounter_diagnoses` directly to `bridge_encounter_procedures` using `encounter_key`.
    - **Efficiency**: COMPLETELY BYPASSED the massive `fact_encounters` table. The query only touched the relevant relationship tables, avoiding the overhead of the central transaction table.
- **Verdict**: **Significant Win (2.8x)**.
    - **Insight**: This demonstrates the power of the Bridge Table pattern. It isolates the "Many-to-Many" analysis from the heavy Fact table.
